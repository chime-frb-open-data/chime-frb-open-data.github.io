
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Open Data Releases for CHIME/FRB">
      
      
      
        <meta name="author" content="Shiny Brar">
      
      
      <link rel="icon" href="../material/chess">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.3">
    
    
      
        <title>Use the CHIME/FRB Beam Model - CHIME/FRB Open Data</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.5143246d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#coordinate-conventions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CHIME/FRB Open Data" class="md-header__button md-logo" aria-label="CHIME/FRB Open Data" data-md-component="logo">
      
  <img src="../static/chime-frb-logo-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CHIME/FRB Open Data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Use the CHIME/FRB Beam Model
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/chime-frb-open-data/chime-frb-open-data.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    chime-frb-open-data/chime-frb-open-data.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CHIME/FRB Open Data" class="md-nav__button md-logo" aria-label="CHIME/FRB Open Data" data-md-component="logo">
      
  <img src="../static/chime-frb-logo-small.png" alt="logo">

    </a>
    CHIME/FRB Open Data
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/chime-frb-open-data/chime-frb-open-data.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    chime-frb-open-data/chime-frb-open-data.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Get Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-releases/" class="md-nav__link">
        Releases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-formats/" class="md-nav__link">
        Formats
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          VOEvents
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="VOEvents" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          VOEvents
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../voevents/" class="md-nav__link">
        Welcome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../voevents-faq/" class="md-nav__link">
        FAQs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../static/CHIMEFRB_VOEvent_Service_for_External_Subscribers.pdf" class="md-nav__link">
        Presentation Slides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/chime-frb-open-data/chime-frb-open-data.github.io/blob/929acb72c0f0ce370ff414ba22f303c367fca81d/docs/notebooks/chimefrb_voevent_tutorial.ipynb" class="md-nav__link">
        Notebook Tutorial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Catalog 1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Catalog 1" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Catalog 1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../catalog/" class="md-nav__link">
        Read the Catalog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exposure/" class="md-nav__link">
        Make an Exposure Map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../localization/" class="md-nav__link">
        Make a Localization Plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../waterfall/" class="md-nav__link">
        Make a Waterfall Plot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../injections/" class="md-nav__link">
        Read the Injection Data
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Use the CHIME/FRB Beam Model
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Use the CHIME/FRB Beam Model
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#coordinate-conventions" class="md-nav__link">
    Coordinate Conventions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-beam-model-sensitivities" class="md-nav__link">
    Generating beam model sensitivities
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code/" class="md-nav__link">
        Previous Releases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#coordinate-conventions" class="md-nav__link">
    Coordinate Conventions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-beam-model-sensitivities" class="md-nav__link">
    Generating beam model sensitivities
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/chime-frb-open-data/chime-frb-open-data.github.io/edit/master/docs/beam-model.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Use the CHIME/FRB Beam Model</h1>
                
                <p><em>Authors: Paul Scholz, Marcus Merryfield</em></p>
<p>The beam model used for various analyses in the First CHIME/FRB Catalog is now available to download. The instructions for installation may be found in the CHIME/FRB beam model <a href="https://github.com/chime-frb-open-data/chime-frb-beam-model">GitHub repository</a>. This tutorial will guide the user on some useful routines the beam model can perform. Note that this release of the beam model only encompasses the version used for analysis in the First CHIME/FRB Catalog. The CHIME primary beam model is still being improved (see e.g. <a href="https://arxiv.org/abs/2201.11822">https://arxiv.org/abs/2201.11822</a>), and as such the CHIME/FRB composite beam model (which includes both the CHIME/FRB synthesized FFT beams and the CHIME primary beam) will likely be updated in the future.</p>
<h2 id="coordinate-conventions">Coordinate Conventions<a class="headerlink" href="#coordinate-conventions" title="Permanent link">&para;</a></h2>
<p>Before getting started with the CHIME/FRB beam model, it is useful to understand the coordinate convention used:</p>
<ul>
<li>In the grid we use x and y as coordinates which are angles in degrees from the origin.</li>
<li>As an origin, (x,y)=(0,0), we use the zenith, which the beam grid is centered on.</li>
<li>With zenith as the origin, y is degrees north from zenith and x is degrees west from the meridian (i.e. increasing hour angle).</li>
</ul>
<p>These coordinates were chosen based on how L0 forms beams:</p>
<ul>
<li>
<p>The four rows of NS beams will be parallel to meridian</p>
<ul>
<li>The spacings of rows are arbitrary, and we have freedom of where to put them</li>
</ul>
</li>
<li>
<p>Beams will be spaced in each row as a function of zenith angle, ZA</p>
<ul>
<li>Within each row of 256 beams the spacings are fixed based on the FFT (spaced evenly in <code>sin(ZA)</code>)</li>
</ul>
</li>
</ul>
<p>Beams IDs are numbered so that the first digit is the S-N running column (i.e 0-3) and the next three digits are the E-W running column.</p>
<ul>
<li>Beam 0001 is the most south-east beam (Beams X000 are used to process the incoherent beam)</li>
<li>Beam 0255 is the most north-east beam</li>
<li>Beam 3001 is the most south-west beam</li>
<li>Beam 3255 is the most north-west beam</li>
</ul>
<p><img alt="formed beams" src="../static/beam-model/chime_formed_beams.png" />
<em>Diagram of beam labelling. Z denotes the location of zenith in the grid and P denotes the North Celestial Pole. Credit: Mark Halpern</em></p>
<p>The transformation between equatorial coordinates and beam coordinates is shown most clearly when mapping arcs of constant <em>y</em>/<em>Dec</em> map onto equatorial/beam model coordinates, respectively.</p>
<p><img alt="constant y to equatorial" src="../static/beam-model/beam_arcs_in_ra_dec.png" />
<em>Arcs of constant y in equatorial coordinates. Each plotted arc corresponds to the center of a
beam row that is labelled with its NS index. The horizon is represented by a dashed line. Credit: Paul Scholz</em></p>
<p>Some things to note about the above plot:</p>
<ul>
<li>Since the synthesized beams in the EW direction (where CHIME has only 4 elements forming
interferometric baselines) have significant sidelobe structure that is not as suppressed as in the NS
direction (where CHIME has 256 elements), these arcs are a representation of the strip of the sky
a given beam row is sensitive to.</li>
<li>The arcs of constant <em>y</em> arc downwards in declination as one moves away from the meridian. That
means that the sidelobes of beams are always sensitive to sources at lower declination than their
nominal positions.</li>
</ul>
<p><img alt="constant dec to beam" src="../static/beam-model/source_arcs_in_x_y.png" />
<em>Arcs of constant declination in beam grid coordinates. Each arc corresponds to a declination
shown in the legend. Tick marks on the arcs represent the distance a source travels in an hour. The
location of beam rows are shown on the meridian as their NS indexes. The horizon is represented by a
dashed line. Credit: Paul Scholz</em></p>
<p>Some things to note about the above plot:</p>
<ul>
<li>At high declinations, sources spend a lot of time within the beam grid, (and thus the main lobe
of the telescope primary beam) and so we have a large amount of exposure time near the North
Celestial Pole (NCP).</li>
<li>Near the NCP, RA changes very rapidly for small separations on the sky. For example, at decl. = 85◦
(∼beam row 214), beam columns 0 and 3 are separated by 15◦ (1 hour) in RA.</li>
<li>Sources on the sky that are detected outside of the beam grid will always appear at y’s higher than
during their transits. This can be seen in Figure 2 where the declination arcs turn upwards. This
means that sidelobe detections will occur at higher beam rows than at transit and their localizations
will assign a higher declination than the actual source.</li>
</ul>
<h2 id="generating-beam-model-sensitivities">Generating beam model sensitivities<a class="headerlink" href="#generating-beam-model-sensitivities" title="Permanent link">&para;</a></h2>
<p>When generating sensitivities from the CHIME/FRB beam model, there are three important inputs to <code>get_sensitivity</code>. The first is the length <code>N</code> array of beam numbers for which you want to calculate sensitivities. The second is the <code>(M,2)</code> array of beam model <code>(x,y)</code> coordinate positions for which you want to calculate sensitivities. The last is the length <code>K</code> array of frequencies for which to calculate sensitivities. The returned array of sensitivities has shape <code>(M,N,K)</code>. </p>
<p>In the following example, we'll calculate sensitivities for a single beam, at one coordinate position, and for all 16384 CHIME/FRB frequencies. Note that some frequencies in the beam model cannot be appropriately modeled due to interference. This normally isn't an issue, since the missing frequencies are also masked in detected FRBs. However, in cases where you wish to interpolate through these otherwise missing "bad frequencies", the <code>interpolate_bad_freq</code> option is available.</p>
<p><strong>Hint:</strong> to get the most accurate CHIME/FRB-specific values, use the <code>chime-frb-constants</code> package, installable via <code>pip install chime-frb-constants</code>.</p>
<details class="example" open="open"><summary>Beam coordinates</summary><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">chime_frb_constants</span>
<span class="kn">import</span> <span class="nn">cfbm</span>

<span class="c1"># First create a beam model object of the CHIME/FRB composite beam model</span>
<span class="n">bm</span> <span class="o">=</span> <span class="n">cfbm</span><span class="o">.</span><span class="n">CompositeBeamModel</span><span class="p">(</span><span class="n">interpolate_bad_freq</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># First choose a beam number (here we&#39;ll use only one)</span>
<span class="n">beam_no</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1064</span><span class="p">]</span>

<span class="c1"># Next choose a position in the beam. We&#39;ll use the center of our chosen beam</span>
<span class="c1"># at 600 MHz (note the beam shape &amp; size change as a function of frequency)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">get_beam_positions</span><span class="p">(</span><span class="n">beam_no</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">])</span>

<span class="c1"># In this example, squeeze the unused array dimensions, as get_beam_positions </span>
<span class="c1"># returns an NxMx2 array where N is the length of the beam number array and M </span>
<span class="c1"># is the length of the frequencies array</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

<span class="c1"># The last ingredient is a list of frequencies: we&#39;ll get beam sensitivities</span>
<span class="c1"># for all 16k frequencies in chime_frb_constants</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">chime_frb_constants</span><span class="o">.</span><span class="n">FREQ</span>

<span class="c1"># Finally, calculate the sensitivities</span>
<span class="n">sensitivities</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">get_sensitivity</span><span class="p">(</span><span class="n">beam_no</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">freqs</span><span class="p">)</span>

<span class="c1"># Once again, in this example we&#39;ll squeeze unused array dimensions</span>
<span class="n">sensitivities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">sensitivities</span><span class="p">)</span>

<span class="c1"># Now we have our array of sensitivities representing the beam sensitivity in</span>
<span class="c1"># beam 1064, at 16384 frequencies from 400 to 800 MHz, and at the position of the</span>
<span class="c1"># 600 MHz beam center!</span>
</code></pre></div>
</details>
<p>Oftentimes you may want to calculate sensitivities like in the above example, but for (RA, Dec) pairs instead of beam model coordinate pairs. Fortunately there are functions in <code>cfbm</code> to convert between beam model coordinates and sky coordinates given a datetime. <code>cfbm.get_equatorial_from_position</code> converts beam position to equatorial coordinates given a time, and <code>cfbm.get_position_from_equatorial</code> does the reverse.</p>
<details class="example" open="open"><summary>Sky coordinates</summary><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">chime_frb_constants</span>
<span class="kn">import</span> <span class="nn">cfbm</span>

<span class="c1"># Create a beam model, choose a beam number, and generate the frequencies as before</span>
<span class="n">bm</span> <span class="o">=</span> <span class="n">cfbm</span><span class="o">.</span><span class="n">CompositeBeamModel</span><span class="p">(</span><span class="n">interpolate_bad_freq</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">beam_no</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1064</span><span class="p">]</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">chime_frb_constants</span><span class="o">.</span><span class="n">FREQ</span>

<span class="c1"># Setting the RA and Dec coordinates, choosing a time, and getting the corresponding</span>
<span class="c1"># x and y coordinates</span>
<span class="n">ra</span> <span class="o">=</span> <span class="mf">370.7</span>
<span class="n">dec</span> <span class="o">=</span> <span class="mf">24.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2022</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">cfbm</span><span class="o">.</span><span class="n">get_position_from_equatorial</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>

<span class="c1"># Finally, get the beam sensitivities with the (x,y) position and squeeze</span>
<span class="c1"># unused dimensions</span>
<span class="n">sensitivities</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">get_sensitivity</span><span class="p">(</span><span class="n">beam_no</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">freqs</span><span class="p">)</span>
<span class="n">sensitivities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">sensitivities</span><span class="p">)</span>
</code></pre></div>
</details>
<p><img alt="example sensitivities" src="../static/beam-model/example_beam_spectrum.png" />
<em>A plot of the sensitivities generated in the first example. Credit: Marcus Merryfield</em></p>
<p>The output sensitivities from the beam model range from 0 to slightly above 1. The value can be interpreted as the relative sensitivity compared to the center of the CHIME primary beam.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../injections/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Read the Injection Data" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Read the Injection Data
            </div>
          </div>
        </a>
      
      
        
        <a href="../code/" class="md-footer__link md-footer__link--next" aria-label="Next: Previous Releases" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Previous Releases
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2020 CHIME/FRB Collaboration
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["tabs", "instant"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f89c2efe.min.js"></script>
      
    
  </body>
</html>