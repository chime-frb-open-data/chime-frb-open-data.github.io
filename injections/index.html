
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Open Data Releases for CHIME/FRB">
      
      
      
        <meta name="author" content="Shiny Brar">
      
      
      <link rel="icon" href="../material/chess">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.3">
    
    
      
        <title>Read the Injection Data - CHIME/FRB Open Data</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.5143246d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CHIME/FRB Open Data" class="md-header__button md-logo" aria-label="CHIME/FRB Open Data" data-md-component="logo">
      
  <img src="../static/chime-frb-logo-small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CHIME/FRB Open Data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Read the Injection Data
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/chime-frb-open-data/chime-frb-open-data.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    chime-frb-open-data/chime-frb-open-data.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CHIME/FRB Open Data" class="md-nav__button md-logo" aria-label="CHIME/FRB Open Data" data-md-component="logo">
      
  <img src="../static/chime-frb-logo-small.png" alt="logo">

    </a>
    CHIME/FRB Open Data
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/chime-frb-open-data/chime-frb-open-data.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    chime-frb-open-data/chime-frb-open-data.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Get Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-releases/" class="md-nav__link">
        Releases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data-formats/" class="md-nav__link">
        Formats
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          VOEvents
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="VOEvents" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          VOEvents
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../voevents/" class="md-nav__link">
        Welcome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../voevents-faq/" class="md-nav__link">
        FAQs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../static/CHIMEFRB_VOEvent_Service_for_External_Subscribers.pdf" class="md-nav__link">
        Presentation Slides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/chime-frb-open-data/chime-frb-open-data.github.io/blob/929acb72c0f0ce370ff414ba22f303c367fca81d/docs/notebooks/chimefrb_voevent_tutorial.ipynb" class="md-nav__link">
        Notebook Tutorial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Catalog 1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Catalog 1" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Catalog 1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../catalog/" class="md-nav__link">
        Read the Catalog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exposure/" class="md-nav__link">
        Make an Exposure Map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../localization/" class="md-nav__link">
        Make a Localization Plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../waterfall/" class="md-nav__link">
        Make a Waterfall Plot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Read the Injection Data
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../beam-model/" class="md-nav__link">
        Use the CHIME/FRB Beam Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code/" class="md-nav__link">
        Previous Releases
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/chime-frb-open-data/chime-frb-open-data.github.io/edit/master/docs/injections.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Read the Injection Data</h1>
                
                <p><em>Author: Marcus Merryfield</em></p>
<p>The injections dataset used for catalog 1 is separated into two files, available in the <a href="https://chime-frb-open-data.github.io/data-releases/">data releases section</a>. The first encompasses the full set of 5 million synthetic FRBs which were generated from population distributions based on The First CHIME/FRB Catalog. The second encompasses a subset of these 5 million bursts (~85,000 total) which were actually injected into the live CHIME/FRB intensity data stream. The first file is available as an <code>hdf5</code> file, while the second is available as a pickle file intended to be read by the <a href="https://pandas.pydata.org/"><code>pandas</code>
library</a> as a <code>DataFrame</code>.</p>
<details class="example" open="open"><summary>Read in the 5 million synthetic pulses</summary><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">h5py</span>

<span class="n">fn</span> <span class="o">=</span> <span class="s2">&quot;chimefrb_catalog1_injections_full.h5&quot;</span>
<span class="n">datafile</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="c1"># datafile.keys() will show the sets of data available:</span>
<span class="c1"># [&#39;frb&#39;, &#39;freq&#39;, &#39;injection_format&#39;, &#39;to_inject&#39;, &#39;to_inject_fit_spec_coeffs&#39;]</span>

<span class="c1"># Create datasets: &#39;frb&#39;</span>
<span class="n">dset_frb</span> <span class="o">=</span> <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;frb&#39;</span><span class="p">]</span>
<span class="n">data_frb</span> <span class="o">=</span> <span class="n">dset_frb</span><span class="p">[()]</span>

<span class="c1"># &#39;freq&#39;</span>
<span class="n">dset_freq</span> <span class="o">=</span> <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span>
<span class="n">data_freq</span> <span class="o">=</span> <span class="n">dset_freq</span><span class="p">[()]</span>

<span class="c1"># &#39;injection_format&#39;</span>
<span class="n">dset_inj_format</span> <span class="o">=</span> <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;injection_format&#39;</span><span class="p">]</span>
<span class="n">data_inj_format</span> <span class="o">=</span> <span class="n">dset_inj_format</span><span class="p">[</span><span class="s1">&#39;frb&#39;</span><span class="p">][()]</span>

<span class="c1"># &#39;to_inject&#39;</span>
<span class="n">dset_to_inj</span> <span class="o">=</span> <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;to_inject&#39;</span><span class="p">]</span>
<span class="n">data_to_inj</span> <span class="o">=</span> <span class="n">dset_to_inj</span><span class="p">[()]</span>

<span class="c1"># &#39;to_inject_fit_spec_coeffs&#39;</span>
<span class="n">dset_speccoeffs</span> <span class="o">=</span> <span class="n">datafile</span><span class="p">[</span><span class="s1">&#39;to_inject_fit_spec_coeffs&#39;</span><span class="p">]</span>
<span class="n">data_speccoeffs</span> <span class="o">=</span> <span class="n">dset_speccoeffs</span><span class="p">[()]</span>
</code></pre></div>
</details>
<details class="hint"><summary>MetaData descriptions</summary><p>Description for each of the datafile keys:</p>
<ul>
<li><code>frb</code>: The dataset for all 5 million FRBs (hint: empty tuples retrieve all data for <code>hdf5</code> datasets). The <code>data_frb.dtype</code> shows which attributes are available in this dataset:<ul>
<li><code>loc_ind</code>: The index of the sky location chosen for a given FRB. (TODO: is this interpretation correct, and is the information of sky location available anywhere? I guess through x and y beam coords? When I sort the array (<code>sorted(data_frb['loc_ind'])</code>), lots of repeated positions...)</li>
<li><code>dm</code>: The DM of a given FRB, in pc/cm^3.</li>
<li><code>width</code>: The intrinsic width of a given FRB, in s.</li>
<li><code>scat_ref</code>: The scattering time of a given FRB, in s, at a reference frequency of (?) (TODO: reference frequency of scattering time? At least I think that's what <code>_ref</code> refers to!)</li>
<li><code>spec_coeffs</code>: The array of three spectral coefficients for an FRB. The three indices of <code>spec_coeffs</code> give the log normalization (index 0), spectral index (index 1), spectral running (index 2) (TODO: Very uncertain about these! Definitely needs double checking... Mainly the index 0, as in <code>data_inj_format</code>, I can see <code>spindex</code> matches index 1 and <code>running</code> matches index 2)</li>
<li><code>x</code>: The CHIME/FRB beam model x coordinate for the given FRB</li>
<li><code>y</code>: The CHIME/FRB beam model y coordinate for the given FRB</li>
<li><code>ra</code>, <code>dec</code>, <code>to_inf</code>, and <code>toa_inf_offset</code> are unused</li>
</ul>
</li>
<li><code>freq</code>: The dataset of 1024 frequencies (~400-800 MHz) used for determining the spectral properties for each FRB.</li>
<li><code>injection_format</code>: A goup which has one key containing a dataset (<code>datafile['injection_format']['frb']</code>) with information for the 5 million FRBs in the format expected by the injection API. The <code>data_inj_format.dtype</code> shows which attributes are available in this dataset:<ul>
<li><code>beam_no</code>: The CHIME/FRB beam number for the injection. Given as -1 for the majority of events, as they were not put up for injection. For the frbs which were put up for injection, there are four beam columns: the zeroeth column has beams <code>0-255</code>, the first has beams <code>1000-1255</code>, the second has beams <code>2000-2255</code>, and the third has beams <code>3000-3255</code>.</li>
<li><code>injection_program_id</code>: The name of the injection program used to identify sets of injected bursts. In this data, the id has not been filled yet, and it has been temporarily populated with the index.</li>
<li><code>beam_x</code> and <code>beam_y</code>: Same as <code>x</code> and <code>y</code> for the <code>frb</code> key.</li>
<li><code>dm</code>: Same as in the <code>frb</code> key.</li>
<li><code>tau_1_ghz</code>: The scattering time referenced to 1 GHz, in ?? (TODO: is this ms or s? I want to say ms based on values but unsure)</li>
<li><code>pulse_width_ms</code>: The intrinsic width of a given FRB, in ms.</li>
<li><code>fluence</code>: The fluence of a given FRB, in Jy ms.</li>
<li><code>spindex</code> and <code>running</code>: Same as index 1 and 2 of <code>spec_coeffs</code> for the <code>frb</code> key.</li>
<li><code>to_inject</code>: The boolean stating whether or not the burst made the cut into the <code>to_inject</code> dataset.</li>
<li><code>injected</code>: The boolean stating whether a given burst has yet been injected. Note that since this information was updated in a different file, all values here are <code>False</code>.</li>
</ul>
</li>
<li><code>to_inject</code>: The dataset of ~97,000 bursts which are a subset of the 5 million that passed the SNR estimate cut to go up for injection. Note only ~85,000 of these were injected, as some injections were lost due to networking issues.<ul>
<li><code>frb_ind</code>: The index in the <code>injection_format</code> corresponding to a given <code>to_inject</code> burst.</li>
<li><code>beam_id</code>: Same as <code>beam_no</code> in the <code>injection_format</code> key.</li>
<li><code>snr_estimate</code>: The estimated signal-to-noise of the injected events, determining whether the event would be put up for injection, calculated using the radiometer equation. For the <code>to_inject</code> dataset, the cutoff SNR was set to 20. While this is significantly higher than the SNR cutoff of 9 used in L1 for the majority of the First CHIME/FRB Catalog, the adjustment was necessary because the estimated SNR using the idealized assumptions in the radiometer equation was far too optimistic compared to actual detection SNRs in initial tests.</li>
<li><code>fluence_spectrum</code>: An array with 1024 fluence values from 400 to 800 MHz, giving the time-integrated fluence spectrum of a synthesized FRB.</li>
</ul>
</li>
<li><code>to_inject_fit_spec_coeffs</code>: The array of fit spectral coefficients for the ~97,000 <code>to_inject</code> events. The array indices are the same as given for <code>spec_coeffs</code> in the <code>frb</code> dataset. These fits were used as the best estimate of what spectral coefficients would be recovered from CHIME/FRB intensity data, based on the <code>fluence_spectrum</code> of the <code>to_inject</code> bursts. (TODO: A little unsure of this definition!)</li>
</ul>
</details>
<details class="example" open="open"><summary>Read in the ~85,000 injected events</summary><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read in the pickle file as a pandas DataFrame</span>
<span class="n">fn</span> <span class="o">=</span> <span class="s2">&quot;chimefrb_catalog1_injections.p&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

<span class="c1"># Now separate the data into categories: detected, non-detected, and RFI</span>
<span class="n">snr_threshold</span> <span class="o">=</span> <span class="mf">9.</span>
<span class="n">rfi_threshold</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="n">high_snr_override</span> <span class="o">=</span> <span class="mf">100.</span>

<span class="c1"># Make a detection mask following CHIME/FRB pipeline logic</span>
<span class="n">detected_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
    <span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">bonsai_snr</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">snr_threshold</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">l2_rfi_grade</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">rfi_threshold</span><span class="p">,</span>
            <span class="n">data</span><span class="o">.</span><span class="n">bonsai_snr</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">high_snr_override</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Create arrays of detected &amp; non-detected injections</span>
<span class="n">det</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">detected_mask</span><span class="p">]</span>
<span class="n">nondet</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">detected_mask</span><span class="p">]</span>

<span class="c1"># Make an RFI mask, where RFI are the subset of non-detections which had</span>
<span class="c1"># SNRs above the SNR threshold</span>
<span class="n">rfi_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">nondet</span><span class="o">.</span><span class="n">l2_rfi_grade</span><span class="p">),</span>
    <span class="n">nondet</span><span class="o">.</span><span class="n">bonsai_snr</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">snr_threshold</span>
<span class="p">)</span>

<span class="c1"># Create array of RFI injections &amp; update non-detected injections</span>
<span class="n">rfi</span> <span class="o">=</span> <span class="n">nondet</span><span class="p">[</span><span class="n">rfi_mask</span><span class="p">]</span>
<span class="n">nondet</span> <span class="o">=</span> <span class="n">nondet</span><span class="p">[</span><span class="o">~</span><span class="n">rfi_mask</span><span class="p">]</span>
</code></pre></div>
</details>
<details class="hint"><summary>MetaData descriptions</summary><p>Descriptions for each of the columns in the <code>DataFrame</code> (listed via <code>data.keys()</code>):</p>
<ul>
<li><code>beam_x</code>: The x position of the injection in CHIME/FRB beam coordinates. The CHIME/FRB beam model is called at an (x,y) coordinate pair to include the forward modelled effect of the beam on the synthetic pulses.</li>
<li><code>beam_y</code>: The y position of the injection in CHIME/FRB beam coordinates.</li>
<li><code>beams</code>: An array of CHIME/FRB beam numbers which the synthetic pulse was injected into. For the First CHIME/FRB Catalog, injections were performed in single beams only. There are four beam columns: the zeroeth column has beams <code>0-255</code>, the first has beams <code>1000-1255</code>, the second has beams <code>2000-2255</code>, and the third has beams <code>3000-3255</code>.</li>
<li><code>bonsai_snr</code>: The signal-to-noise ratio (SNR) reported by CHIME/FRB's L1 pipeline. For the majority of the observing period in the First CHIME/FRB Catalog, the detection threshold was at an SNR of 9.</li>
<li><code>dm_det</code> and <code>dm_inj</code>: The detection DM as reported by the L1 pipeline (<code>_det</code>, if available) and the synthetic pulse's injected DM (<code>_inj</code>), in pc/cm^3.</li>
<li><code>dm_err_det</code>: The error in the DM as reported by the L1 pipeline, in pc/cm^3. Note that DM errors are discrete as a function of L1 tree index.</li>
<li><code>dm_gal_ne_2001_max</code> and <code>dm_gal_ymw_2016_max</code>: The maximum DM along the line of site estimated by the NE2001 and YMW16 Galactic DM models, in pc/cm^3. The detected position for synthetic pulses is approximately the center of the beam which they were injected into, since the injections were only performed in single beams.</li>
<li><code>fluence_jy_ms_inj</code>: The estimated injection fluence of the synthetic pulse, in Jy ms.</li>
<li><code>l1_rfi_grade</code>: The RFI grade (scale of 10) reported by the L1 pipeline.</li>
<li><code>l2_rfi_grade</code>: The RFI grade (scale of 10) reported by the L2/L3 pipeline. The threshold for a detection to be considered astrophysical (as opposed to RFI) is 5.</li>
<li><code>pos_dec_deg_det</code> and <code>pos_ra_deg_det</code>: The approximate RA and Dec positions of the detections, in degrees. As injections were performed in single beams, represents approximate the RA and Dec of the beam center at the time of detection.</li>
<li><code>pulse_width_ms_det</code> and <code>pulse_width_ms_inj</code>: The detected pulse width as reported by the L1 pipeline and the synthetic pulse's injected intrinsic width, in ms. Note that L1 does not record which width bin had the highest SNR detection, so the detected width is reported as 2x the size of the time bins in the detection tree.</li>
<li><code>spectral_index_det</code> and <code>spectral_index_inj</code>: The detected spectral index as reported by the L1 pipeline and the synthetic pulse's injected spectral index. L1 only reports two possible spectral indices: +3, or -3.</li>
<li><code>spectral_running_inj</code>: The synthetic pulse's injected spectral 'running', using the running power-law with which CHIME/FRB models real detections. Note that since intensity data is not saved for injected events and L1 only considers a regular power-law weighting there is no detected value for spectral running.</li>
<li><code>t_err_ms_det</code>: The approximate timing error from L1 for the detected pulse, in ms.</li>
<li><code>t_utc_det</code>, <code>t_utc_expected</code>, and <code>t_utc_inj</code>: The UTC time of the detection as reported by the L1 pipeline, the expected UTC time of synthetic pulse detection before injection, and the UTC time which the synthetic pulse was actually injected.</li>
<li><code>tau_1_ghz_ms_inj</code>: The scattering index at 1 GHz of the synthetic pulse, in ms.</li>
<li><code>tree_index_det</code>: The tree index of the detection. Tree index is indexed starting at zero, going to a maximum of four, with each sequential tree increasing the temporal binning by a power of two.</li>
</ul>
</details>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../waterfall/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Make a Waterfall Plot" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Make a Waterfall Plot
            </div>
          </div>
        </a>
      
      
        
        <a href="../beam-model/" class="md-footer__link md-footer__link--next" aria-label="Next: Use the CHIME/FRB Beam Model" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Use the CHIME/FRB Beam Model
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2020 CHIME/FRB Collaboration
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["tabs", "instant"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f89c2efe.min.js"></script>
      
    
  </body>
</html>